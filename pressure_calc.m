%% Constants
clc; 
clear; 
alpha = deg2rad(10); 
velocity1 = 7396.6; %m/s
velocity = [7396.53003203636	7396.52880332591	7396.52755303814	7396.52628079412	7396.52498620828	7396.52366888829	7396.52232843492	7396.52096444192	7396.51957649592	7396.51816417630	7396.51672705502	7396.51526469656	7396.51377665774	7396.51226248758	7396.51072172720	7396.50915390967	7396.50755855983	7396.50593519420	7396.50428332080	7396.50260243903	7396.50089203946	7396.49915160376	7396.49738060446	7396.49557850486	7396.49374475880	7396.49187881056	7396.48998009465	7396.48804803564	7396.48608204802	7396.48408153598	7396.48204589324	7396.47997450289	7396.47786673719	7396.47572195737	7396.47353951343	7396.47131874397	7396.46905897598	7396.46675952462	7396.46441969304	7396.46203877214	7396.45961604037	7396.45715076351	7396.45464219445	7396.45208957296	7396.44949212547	7396.44684906480	7396.44415958998	7396.44142288595	7396.43863812335	7396.43580445825	7396.43292103191	7396.42998697051	7396.42700138487	7396.42396337023	7396.42087200589	7396.41772635505	7396.41452546439	7396.41126836391	7396.40795406654	7396.40458156790	7396.40114984596	7396.39765786074	7396.39410455401	7396.39048884897	7396.38680964988	7396.38306584178	7396.37925629014	7396.37537984048	7396.37143531809	7396.36742152759	7396.36333725264	7396.35918125553	7396.35495227681	7396.35064903495	7396.34627022587	7396.34181452263	7396.33728057497	7396.33266700893	7396.32797242642	7396.32319540481	7396.31833449647	7396.31338822838	7396.30835510164	7396.30323359104	7396.29802214457	7396.29271918299	7396.28732309933	7396.28183225839	7396.27624499628	7396.27055961988	7396.26477440634	7396.25888760257	7396.25289742470	7396.24680205753	7396.24059965399	7396.23428833459	7396.22786618683	7396.22133126464	7396.21468158777	7396.20791514121	7396.20102987457	7396.19402370146	7396.18689449887	7396.17964010649	7396.17225832610	7396.16474692088	7396.15710361475	7396.14932609165	7396.14141199487	7396.13335892631	7396.12516444579	7396.11682607027	7396.10834127311	7396.09970748335	7396.09092208484	7396.08198241553	7396.07288576665	7396.06362938183	7396.05421045635	7396.04462613622	7396.03487351738	7396.02494964475	7396.01485151138	7396.00457605757	7395.99412016984	7395.98348068011	7395.97265436465	7395.96163794315	7395.95042807771	7395.93902137182	7395.92741436938	7395.91560355357	7395.90358534589	7395.89135610496	7395.87891212553	7395.86624963728	7395.85336480371	7395.84025372097	7395.82691241668	7395.81333684876	7395.79952290412	7395.78546639753	7395.77116307024	7395.75660858880	7395.74179854364	7395.72672844783	7395.71139373567	7395.69578976130	7395.67991179733	7395.66375503340	7395.64731457471	7395.63058544053	7395.61356256274	7395.59624078423	7395.57861485740	7395.56067944253	7395.54242910620	7395.52385831961	7395.50496145693	7395.48573279360	7395.46616650457	7395.44625666257	7395.42599723631	7395.40538208865	7395.38440497473	7395.36305954011	7395.34133931882	7395.31923773144	7395.29674808305	7395.27386356128	7395.25057723419	7395.22688204819	7395.20277082594	7395.17823626412	7395.15327093129	7395.12786726556	7395.10201757239	7395.07571402220	7395.04894864805	7395.02171334317	7394.99399985859	7394.96579980057	7394.93710462811	7394.90790565036	7394.87819402397	7394.84796075046	7394.81719667344	7394.78589247591	7394.75403867739	7394.72162563109	7394.68864352098	7394.65508235883	7394.62093198116	7394.58618204624	7394.55082203091	7394.51484122738	7394.47822874008	7394.44097348230	7394.40306417284	7394.36448933265	7394.32523728133	7394.28529613360	7394.24465379573	7394.20329796188	7394.16121611037	7394.11839549993	7394.07482316582	7394.03048591595	7393.98537032687	7393.93946273973	7393.89274925617	7393.84521573409	7393.79684778343	7393.74763076180	7393.69754977005	7393.64658964781	7393.59473496889	7393.54197003664	7393.48827887920	7393.43364524471	7393.37805259639	7393.32148410755	7393.26392265653	7393.20535082153	7393.14575087537	7393.08510478012	7393.02339418171	7392.96060040433	7392.89670444488	7392.83168696719	7392.76552829621	7392.69820841210	7392.62970694416	7392.56000316474	7392.48907598298	7392.41690393844	7392.34346519468	7392.26873753264	7392.19269834400	7392.11532462433	7392.03659296620	7391.95647955212	7391.87496014739	7391.79201009280	7391.70760429720	7391.62171722999	7391.53432291341	7391.44539491473	7391.35490633835	7391.26282981764	7391.16913750681	7391.07380107244	7390.97679168505	7390.87808001042	7390.77763620074	7390.67542988569	7390.57143016333	7390.46560559078	7390.35792417481	7390.24835336226	7390.13686003021	7390.02341047612	7389.90797040766	7389.79050493248	7389.67097854770	7389.54935512931	7389.42559792129	7389.29966952467	7389.17153188627	7389.04114628733	7388.90847333189	7388.77347293502	7388.63610431082	7388.49632596021	7388.35409565850	7388.20937044279	7388.06210659909	7387.91225964928	7387.75978433779	7387.60463461810	7387.44676363895	7387.28612373041	7387.12266638955	7386.95634226605	7386.78710114743	7386.61489194407	7386.43966267398	7386.26136044729	7386.07993145051	7385.89532093043	7385.70747317789	7385.51633151113	7385.32183825891	7385.12393474340	7384.92256126265	7384.71765707288	7384.50916037040	7384.29700827324	7384.08113680245	7383.86148086313	7383.63797422505	7383.41054950304	7383.17913813695	7382.94367037135	7382.70407523483	7382.46028051896	7382.21221275691	7381.95979720169	7381.70295780399	7381.44161718973	7381.17569663714	7380.90511605348	7380.62979395140	7380.34964742484	7380.06459212457	7379.77454223328	7379.47941044028	7379.17910791576	7378.87354428459	7378.56262759972	7378.24626431512	7377.92435925820	7377.59681560192	7377.26353483621	7376.92441673914	7376.57935934741	7376.22825892649	7375.87100994016	7375.50750501959	7375.13763493189	7374.76128854813	7374.37835281086	7373.98871270097	7373.59225120419	7373.18884927683	7372.77838581112	7372.36073759982	7371.93577930038	7371.50338339842	7371.06342017060	7370.61575764693	7370.16026157241	7369.69679536808	7369.22522009135	7368.74539439576	7368.25717449000	7367.76041409637	7367.25496440838	7366.74067404785	7366.21738902112	7365.68495267473	7365.14320565019	7364.59198583817	7364.03112833182	7363.46046537941	7362.87982633617	7362.28903761532	7361.68792263838	7361.07630178459	7360.45399233956	7359.82080844312	7359.17656103621	7358.52105780709	7357.85410313652	7357.17549804217	7356.48504012208	7355.78252349728	7355.06773875340	7354.34047288145	7353.60050921758	7352.84762738193	7352.08160321652	7351.30220872211	7350.50921199410	7349.70237715742	7348.88146430041	7348.04622940761	7347.19642429157	7346.33179652355	7345.45208936318	7344.55704168696	7343.64638791576	7342.71985794108	7341.77717705031	7340.81806585069	7339.84224019223	7338.84941108943	7337.83928464173	7336.81156195284	7335.76593904885	7334.70210679500	7333.61975081137	7332.51855138710	7331.39818339354	7330.25831619594	7329.09861356392	7327.91873358060	7326.71832855035	7325.49704490528	7324.25452311023	7322.99039756651	7321.70429651419	7320.39584193291	7319.06464944140	7317.71032819546	7316.33248078453	7314.93070312675	7313.50458436263	7312.05370674711	7310.57764554020	7309.07596889608	7307.54823775060	7305.99400570738	7304.41281892216	7302.80421598576	7301.16772780533	7299.50287748407	7297.80918019935	7296.08614307913	7294.33326507689	7292.55003684477	7290.73594060521	7288.89045002083	7287.01303006267	7285.10313687683	7283.16021764927	7281.18371046913	7279.17304419017	7277.12763829063	7275.04690273135	7272.93023781215	7270.77703402658	7268.58667191486	7266.35852191515	7264.09194421315	7261.78628858991	7259.44089426793	7257.05508975561	7254.62819268995	7252.15950967752	7249.64833613375	7247.09395612060	7244.49564218241	7241.85265518016	7239.16424412410	7236.42964600462	7233.64808562157	7230.81877541194	7227.94091527593	7225.01369240141	7222.03628108687	7219.00784256278	7215.92752481146	7212.79446238549	7209.60777622456	7206.36657347102	7203.06994728397	7199.71697665197	7196.30672620449	7192.83824602205	7189.31057144515	7185.72272288197	7182.07370561500	7178.36250960655	7174.58810930323	7170.74946343949	7166.84551484027	7162.87519022276	7158.83739999746	7154.73103806853	7150.55498163352	7146.30809098256	7141.98920929721	7137.59716244877	7133.13075879658	7128.58878898594	7123.97002574616	7119.27322368858	7114.49711910478	7109.64042976515	7104.70185471786	7099.68007408834	7094.57374887957	7089.38152077312	7084.10201193128	7078.73382480027	7073.27554191482	7067.72572570424	7062.08291830017	7056.34564134616	7050.51239580937	7044.58166179447	7038.55189836005	7032.42154333772	7026.18901315407	7019.85270265591	7013.41098493878	7006.86221117919	7000.20471047076	6993.43678966460	6986.55673321411	6979.56280302459	6972.45323830797	6965.22625544288	6957.88004784054	6950.41278581662	6942.82261646963	6935.10766356608	6927.26602743276	6919.29578485667	6911.19498899285	6902.96166928067	6894.59383136886	6886.08945704989	6877.44650420403	6868.66290675363	6859.73657462812	6850.66539374013	6841.44722597349	6832.07990918333	6822.56125720911	6812.88905990102	6803.06108316030	6793.07506899428	6782.92873558649	6772.61977738270	6762.14586519349	6751.50464631396	6740.69374466139	6729.71076093145	6718.55327277382	6707.21883498786	6695.70497973920	6684.00921679795	6672.12903379946	6660.06189652837	6647.80524922684	6635.35651492787	6622.71309581454	6609.87237360616	6596.83170997220	6583.58844697505	6570.13990754249	6556.48339597094	6542.61619846051	6528.53558368284	6514.23880338286	6499.72309301555	6484.98567241871	6470.02374652301	6454.83450610033	6439.41512855166	6423.76277873564	6407.87460983904	6391.74776429031	6375.37937471748	6358.76656495162	6341.90645107722	6324.79614253058	6307.43274324773	6289.81335286301	6271.93506795964	6253.79498337376	6235.39019355299	6216.71779397118	6197.77488260035	6178.55856144146	6159.06593811519	6139.29412751406	6119.24025351735	6098.90145077007	6078.27486652731	6057.35766256532	6036.14701716060	6014.64012713832	5992.83420999127	5970.72650607073	5948.31428085021	5925.59482726365	5902.56546811882	5879.22355858733	5855.56648877218	5831.59168635401	5807.29661931682	5782.67879875433	5757.73578175765	5732.46517438519	5706.86463471539	5680.93187598308	5654.66466979990	5628.06084945930	5601.11831332648	5573.83502831358	5546.20903344018	5518.23844347924	5489.92145268837	5461.25633862612	5432.24146605306	5402.87529091701	5373.15636442179	5343.08333717865	5312.65496343934	5281.87010540956	5250.72773764146	5219.22695150348	5187.36695972577	5155.14710101903	5122.56684476456	5089.62579577290	5056.32369910822	5022.66044497548	4988.63607366684	4954.25078056381	4919.50492119100	4884.39901631734	4848.93375710011	4813.11001026670	4776.92882332903	4740.39142982478	4703.49925457944	4666.25391898285	4628.65724627330	4590.71126682204	4552.41822341059	4513.78057649277	4474.80100943297	4435.48243371184	4395.82799408990	4355.84107371931	4315.52529919370	4274.88454552501	4233.92294103643	4192.64487215961	4151.05498812413	4109.15820552645	4066.95971276546	4024.46497433092	3981.67973493091	3938.61002344373	3895.26215667936	3851.64274293518	3807.75868533013	3763.61718490105	3719.22574344476	3674.59216608876	3629.72456357333	3584.63135422732	3539.32126561968	3493.80333586856	3448.08691458934	3402.18166346318	3356.09755640696	3309.84487932588	3263.43422942954	3216.87651409257	3170.18294924069	3123.36505724326	3076.43466429371	3029.40389725907	2982.28517998052	2935.09122900691	2887.83504874391	2840.52992600181	2793.18942392561	2745.82737529177	2698.45787515691	2651.09527284433	2603.75416325552	2556.44937749474	2509.19597279612	2462.00922174364	2414.90460077648	2367.89777797298	2321.00460010861	2274.24107898496	2227.62337702872	2181.16779216136	2134.89074194278	2088.80874699399	2042.93841370652	1997.29641624872	1951.89947788136	1906.76435159815	1861.90780010908	1817.34657518767	1773.09739640606	1729.17692928491	1685.60176288835	1642.38838689716	1599.55316819677	1557.11232701997	1515.08191268738	1473.47777899229	1432.31555927941	1391.61064127092	1351.37814169599	1311.63288078340	1272.38935668013	1233.66171986151	1195.46374760187	1157.80881857725	1120.70988767418	1084.17946108156	1048.22957174429	1012.87175525985	978.117026300600	943.975855645905	910.458147909883	877.573220050861	845.329780749546	813.735910742900	782.799044200463	752.525951229172	722.922721591666	693.994749721352	665.746721115600	638.182600185757	611.305619639647	585.118271468690	559.622299607632	534.818694330273	510.707688439472	487.288755304048	464.560608788972	442.521205118724	421.167746706404	400.496687973702	380.503743178764	361.183896260574	342.531412699712	324.539853386230	307.202090475970	290.510325207170	274.456107639254	259.030358265984	244.223391445135	230.024940576947	216.424184953859	203.409778194313	190.969878164023	179.092178279070	167.763940076399	156.972026929158	146.702938776608	136.942847731311	127.677634419977	118.892924908786	110.574128059296	102.706473157239	95.2750476536610	88.2648348560243	81.6607514061307	75.4476843820048	69.6105278623283	64.1342187945542	59.0037720115135	54.2043142461480	49.7211169999171	45.5396281274322	41.6455020079109	38.0246281830679	34.6631583510196	31.5475316165666	28.6644979097882	26.0011394971021	23.5448905217447	21.2835545238558	19.2053199039335	17.2987733071951	15.5529109202433	13.9571476852339	12.5013244503586	11.1757130887604	9.97101963084614	8.87838546725055	7.88938669129875	6.99603166061047	6.19075686738568	5.46642121581621	4.81629881290320	4.23407038566158	3.71381344320787	3.24999130652468	2.83744113174687	2.47136105462502	2.14729658439609	1.86112637466004	1.60904749706623	1.38756034071014	1.19345325620074	1.02378705846395	0.875879496588052	0.747289792498182	0.635803343074442	0.539416672617917	0.456322714437614	0.384896491897801	0.323681260648125	0.271375165073131	0.226818453355745	0.188981287054953	0.156952172850095	0.129927036191029	0.107198949093810	0.0881485173033185	0.0722349255637033	0.0589876338389052	0.0479987120413262	0.0389157961771803	0.0314356448112989	0.0252982713900511	0.0202816252264676	0.0161967918252744	0.0128836816779547	0.0102071756527547	0.00805369459979520	0.00632816074070204	0.00495131876602033	0.00385738527079006	0.00299199616710494	0.00231042297074603	0.00177603031702130	0.00135894867099259	0.00103493791460685	0.000784419276758203	0.000591654884915411	0.000444056025937492	0.000331602980829124	0.000246361019751052	0.000182078790327985	0.000133856889171608	9.78758625325302e-05	7.11742297451971e-05	5.14683585465467e-05	3.70071432206089e-05	2.64554460855008e-05	1.88011633637009e-05	1.32815728468681e-05	9.32531909848335e-06	6.50699921969339e-06	4.51183597597146e-06	3.10837315530869e-06	2.12750824582577e-06	1.44649756112891e-06	9.76836165648211e-07	6.55136284100953e-07	4.36309726344781e-07	2.88508060586102e-07	1.89394071704099e-07	1.23414101070681e-07	7.98172553522285e-08	5.12277210344988e-08	3.26235451623416e-08	2.06117918859709e-08	1.29180923414632e-08	8.03003730210990e-09	4.95006275367759e-09	3.02561826479895e-09	1.83342459424376e-09	1.10126422219840e-09	6.55590231441267e-10	3.86738683361028e-10	2.26035932431774e-10	1.30870388850670e-10	7.50477044668858e-11	4.26179298671416e-11	2.39624780214916e-11	1.33376635577417e-11	7.34783381197464e-12	4.00582485949669e-12	2.16071658496385e-12	1.15291056196497e-12	6.08418927380488e-13	3.17493596120821e-13	1.63797312414105e-13	8.35277936509209e-14	4.20938882624182e-14	2.09594883223509e-14	1.03091800602961e-14	5.00790402816243e-15	2.40204566680512e-15	1.13737377395122e-15	5.31524695343061e-16	2.45099171548546e-16	1.11495287380759e-16	5.00223136441073e-17	2.21288139579323e-17	9.65010968706314e-18	4.14740910519748e-18	1.75622787417006e-18	7.32539608478071e-19	3.00893304703358e-19	1.21676858986678e-19	4.84282015271795e-20	1.89654134626852e-20	7.30594706930882e-21	2.76767698301647e-21	1.03074489806064e-21	3.77271405780550e-22	1.35672304490919e-22	4.79212916841949e-23	1.66199171645409e-23	5.65786834366319e-24	1.88998620030341e-24	6.19301200236181e-25	1.98992105770733e-25	6.26774007115539e-26	1.93452903673203e-26	5.84889661372926e-27	1.73160809684459e-27	5.01813142608684e-28	1.42294525311836e-28	3.94659171857909e-29	1.07022541052303e-29	2.83645305942239e-30	7.34426682567392e-31	1.85701728569499e-31	4.58349883728402e-32	1.10384433438554e-32	2.59275023914837e-33	5.93697198372652e-34	1.32472812794160e-34	2.87904548229023e-35	6.09157231736869e-36	1.25419471521126e-36	2.51158103404712e-37	4.88949965116766e-38	9.24913786577673e-39	1.69917662766977e-39	3.03007388843795e-40	5.24225807846407e-41	8.79433776340211e-42	1.42979072356861e-42	2.25157955390211e-43	3.43245066917427e-44	5.06262693829489e-45	7.22021681611805e-46	9.95109562692444e-47	1.32457654424827e-47	1.70177952132393e-48	2.10901422818279e-49	2.51959581144004e-50	2.89986472471295e-51	3.21318347107639e-52	3.42542660505727e-53	3.51091660716042e-54	3.45742876110801e-55	3.26894605712976e-56	2.96533392163738e-57	2.57890232685522e-58	2.14867222692083e-59	1.71376922918767e-60	1.30752068315915e-61	9.53498836886910e-63	6.64083225815547e-64	4.41372136906368e-65	2.79711637263899e-66	1.68879241115754e-67	9.70582886248381e-69	5.30522300919054e-70	2.75554012214205e-71	1.35879086658330e-72	6.35543314370763e-74	2.81696375341321e-75	1.18209060798296e-76	4.69176563596556e-78	1.75959691107045e-79	6.22944353402495e-81	2.07971944784335e-82	6.54082036190180e-84	1.93587064517073e-85	5.38609202566108e-87	1.40719106488120e-88	3.44853386745383e-90	7.91826235822772e-92	1.70154135778987e-93	3.41795943748020e-95	6.41045325440038e-97	1.12120401037414e-98	1.82651003061772e-100	2.76795538051507e-102	3.89712455568121e-104	5.09115777349669e-106	6.16318110379597e-108	6.90443931666697e-110	7.14818567174022e-112	6.82976211616598e-114	6.01375228723023e-116	4.87295957409803e-118	3.62838672438276e-120	2.47892198067290e-122	1.55161650507419e-124	8.88403694351758e-127	4.64580755707594e-129	2.21536607131918e-131	9.61744239528818e-134	3.79478806794478e-136	1.35862860523979e-138	4.40613642098864e-141	1.29212558407801e-143];
gamma = 1.4;
M1 = [27.3497126143491	27.3497080710190	27.3497034479037	27.3496987436021	27.3496939566884	27.3496890857120	27.3496841291967	27.3496790856403	27.3496739535143	27.3496687312633	27.3496634173048	27.3496580100282	27.3496525077949	27.3496469089372	27.3496412117585	27.3496354145321	27.3496295155012	27.3496235128779	27.3496174048431	27.3496111895458	27.3496048651022	27.3495984295958	27.3495918810763	27.3495852175589	27.3495784370243	27.3495715374176	27.3495645166478	27.3495573725873	27.3495501030709	27.3495427058955	27.3495351788195	27.3495275195617	27.3495197258008	27.3495117951750	27.3495037252808	27.3494955136727	27.3494871578619	27.3494786553163	27.3494700034592	27.3494611996685	27.3494522412762	27.3494431255674	27.3494338497796	27.3494244111018	27.3494148066735	27.3494050335840	27.3493950888717	27.3493849695227	27.3493746724703	27.3493641945941	27.3493535327187	27.3493426836130	27.3493316439892	27.3493204105017	27.3493089797463	27.3492973482587	27.3492855125143	27.3492734689260	27.3492612138442	27.3492487435550	27.3492360542793	27.3492231421716	27.3492100033190	27.3491966337399	27.3491830293825	27.3491691861242	27.3491550997699	27.3491407660508	27.3491261806231	27.3491113390669	27.3490962368844	27.3490808694991	27.3490652322541	27.3490493204106	27.3490331291467	27.3490166535558	27.3489998886451	27.3489828293342	27.3489654704535	27.3489478067425	27.3489298328486	27.3489115433250	27.3488929326293	27.3488739951217	27.3488547250637	27.3488351166156	27.3488151638355	27.3487948606770	27.3487742009876	27.3487531785068	27.3487317868641	27.3487100195772	27.3486878700499	27.3486653315704	27.3486423973089	27.3486190603156	27.3485953135188	27.3485711497227	27.3485465616049	27.3485215417148	27.3484960824706	27.3484701761578	27.3484438149260	27.3484169907874	27.3483896956137	27.3483619211339	27.3483336589319	27.3483049004437	27.3482756369550	27.3482458595987	27.3482155593516	27.3481847270325	27.3481533532988	27.3481214286438	27.3480889433942	27.3480558877066	27.3480222515648	27.3479880247769	27.3479531969720	27.3479177575971	27.3478816959139	27.3478450009957	27.3478076617239	27.3477696667846	27.3477310046656	27.3476916636523	27.3476516318245	27.3476108970528	27.3475694469949	27.3475272690917	27.3474843505637	27.3474406784071	27.3473962393897	27.3473510200473	27.3473050066789	27.3472581853433	27.3472105418546	27.3471620617776	27.3471127304241	27.3470625328477	27.3470114538398	27.3469594779248	27.3469065893556	27.3468527721085	27.3467980098785	27.3467422860745	27.3466855838143	27.3466278859191	27.3465691749087	27.3465094329962	27.3464486420823	27.3463867837500	27.3463238392594	27.3462597895412	27.3461946151917	27.3461282964665	27.3460608132749	27.3459921451732	27.3459222713592	27.3458511706655	27.3457788215532	27.3457052021054	27.3456302900205	27.3455540626055	27.3454764967693	27.3453975690153	27.3453172554348	27.3452355316994	27.3451523730537	27.3450677543080	27.3449816498305	27.3448940335396	27.3448048788959	27.3447141588945	27.3446218460565	27.3445279124209	27.3444323295359	27.3443350684506	27.3442360997061	27.3441353933265	27.3440329188100	27.3439286451196	27.3438225406737	27.3437145733368	27.3436047104093	27.3434929186179	27.3433791641058	27.3432634124219	27.3431456285109	27.3430257767023	27.3429038207001	27.3427797235713	27.3426534477351	27.3425249549515	27.3423942063094	27.3422611622155	27.3421257823818	27.3419880258136	27.3418478507971	27.3417052148870	27.3415600748931	27.3414123868682	27.3412621060939	27.3411091870675	27.3409535834885	27.3407952482442	27.3406341333957	27.3404701901633	27.3403033689119	27.3401336191361	27.3399608894445	27.3397851275450	27.3396062802282	27.3394242933517	27.3392391118239	27.3390506795871	27.3388589396009	27.3386638338247	27.3384653032003	27.3382632876341	27.3380577259790	27.3378485560161	27.3376357144355	27.3374191368176	27.3371987576138	27.3369745101263	27.3367463264882	27.3365141376432	27.3362778733246	27.3360374620342	27.3357928310206	27.3355439062578	27.3352906124223	27.3350328728705	27.3347706096160	27.3345037433060	27.3342321931970	27.3339558771309	27.3336747115103	27.3333886112730	27.3330974898669	27.3328012592233	27.3324998297311	27.3321931102093	27.3318810078799	27.3315634283398	27.3312402755327	27.3309114517198	27.3305768574509	27.3302363915339	27.3298899510051	27.3295374310978	27.3291787252108	27.3288137248766	27.3284423197290	27.3280643974693	27.3276798438331	27.3272885425561	27.3268903753388	27.3264852218113	27.3260729594968	27.3256534637755	27.3252266078468	27.3247922626911	27.3243502970316	27.3239005772947	27.3234429675698	27.3229773295689	27.3225035225851	27.3220214034502	27.3215308264922	27.3210316434913	27.3205237036360	27.3019930019887	27.2834895129373	27.2650129767695	27.2465631318961	27.2281397148068	27.2097424600256	27.1913711000658	27.1730253653837	27.1547049843321	27.1364096831125	27.1181391857279	27.0998932139327	27.0816714871844	27.0634737225924	27.0452996348671	27.0271489362681	27.0090213365517	26.9909165429170	26.9728342599518	26.9547741895774	26.9367360309928	26.9187194806177	26.9007242320344	26.8827499759300	26.8647964000359	26.8468631890681	26.8289500246653	26.8110565853270	26.7931825463496	26.7753275797626	26.7574913542631	26.7396735351492	26.7218737842532	26.7040917598727	26.6863271167012	26.6685795057578	26.6508485743151	26.6331339658267	26.6154353198533	26.5977522719872	26.5800844537765	26.5624314926473	26.5447930118251	26.5271686302550	26.5095579625204	26.4919606187603	26.4743762045862	26.4568043209963	26.4392445642895	26.4216965259777	26.4041597926963	26.3866339461140	26.3691185628407	26.3516132143341	26.3341174668047	26.3166308811196	26.2991530127046	26.2816834114446	26.2642216215830	26.2467671816185	26.2293196242015	26.2118784760282	26.1944432577327	26.1770134837784	26.1595886623467	26.1421682952246	26.1247518776903	26.1073388983971	26.0899288392553	26.0725211753124	26.0551153746315	26.0377108981675	26.0203071996420	26.0029037254154	25.9854999143575	25.9680951977165	25.9506889989846	25.9332807337635	25.9158698096256	25.8984556259751	25.8810375739055	25.8636150360555	25.8461873864628	25.8287539904150	25.8113142042992	25.7938673754482	25.7764128419852	25.7589499326657	25.7414779667170	25.7239962536753	25.7065040932203	25.6890007750074	25.6714855784972	25.6539577727823	25.6364166164118	25.6188613572127	25.6012912321094	25.5837054669392	25.5661032762662	25.5484838631920	25.5308464191632	25.5131901237768	25.4955141445816	25.4778176368779	25.4600997435131	25.4423595946751	25.4245963076821	25.4068089867696	25.3889967228740	25.3711585934134	25.3532936620649	25.3354009785388	25.3174795783490	25.2995284825811	25.2815466976564	25.2635332150921	25.2454870112595	25.2274070471371	25.2092922680610	25.1911416034720	25.1729539666586	25.1547282544963	25.1364633471836	25.1181581079744	25.0998113829059	25.0814220005238	25.0629887716026	25.0445104888630	25.0259859266847	25.0074138408155	24.9887929680771	24.9701220260653	24.9513997128482	24.9326247066587	24.9137956655836	24.8944933301922	24.8699934028828	24.8454598985958	24.8208913241771	24.7962861663938	24.7716428916112	24.7469599454646	24.7222357525276	24.6974687159767	24.6726572172513	24.6477996157099	24.6228942482826	24.5979394291190	24.5729334492322	24.5478745761392	24.5227610534963	24.4975911007310	24.4723629126699	24.4470746591619	24.4217244846978	24.3963105080257	24.3708308217617	24.3452834919977	24.3196665579035	24.2939780313263	24.2682158963850	24.2423781090613	24.2164625967858	24.1904672580210	24.1643899618397	24.1382285474996	24.1119808240138	24.0856445697178	24.0592175318320	24.0326974260211	24.0060819359487	23.9793687128294	23.9525553749764	23.9256395073456	23.8986186610760	23.8714903530274	23.8442520653138	23.8169012448339	23.7894353027982	23.7618516142534	23.7341475176029	23.7063203141256	23.6783672674905	23.6502856032698	23.6220725084487	23.5937251309332	23.5652405790554	23.5366159210764	23.5078481846881	23.4789343565124	23.4498713815990	23.4206561629217	23.3912855608740	23.3617563927630	23.3320654323028	23.3022094091073	23.2721850081826	23.2419888694198	23.2116175870870	23.1810677093229	23.1503357376304	23.1194181263714	23.0883112822631	23.0570115638763	23.0255152811349	22.9938186948189	22.9619180160692	22.9298094058964	22.8974889746926	22.8649527817477	22.8321968347698	22.7992170894106	22.7660094487966	22.7325697630656	22.6988938289103	22.6649773891281	22.6308161321794	22.5964056917529	22.5617416463409	22.5268195188228	22.4916347760594	22.4561828284975	22.4204590297861	22.3844586764046	22.3481770073037	22.3116092035608	22.2747503880484	22.2375956251195	22.2001399203078	22.1623782200455	22.1243054113997	22.0859163218263	22.0472057189456	22.0081683103372	21.9687987433585	21.9290916049851	21.8890414216761	21.8486426592643	21.8078897228742	21.7667769568663	21.7252986448113	21.6834490094955	21.6412222129564	21.5986123565529	21.5556134810694	21.5122195668565	21.4684245340091	21.4242222425837	21.3796064928567	21.3345710256253	21.2891095225523	21.2432156065571	21.1968828422546	21.1501047364436	21.1028747386463	21.0551862417021	21.0070325824163	20.9584070422664	20.9093028481683	20.8597131733037	20.8096311380120	20.7590498107484	20.7079622091103	20.6563613009343	20.6042400054675	20.5515911946135	20.4984076942570	20.4446822856700	20.3904077070001	20.3355766548462	20.2801817859221	20.2242157188127	20.1676710358237	20.1105402849293	20.0528159818200	19.9944906120536	19.9355566333123	19.8760064777692	19.8158325545679	19.7550272524162	19.6935829423000	19.6314919803185	19.5687467106448	19.5053394686148	19.4412625839483	19.3765083841051	19.3110691977799	19.2449373585391	19.1781052086026	19.1105651027754	19.0423094125303	18.9733305302472	18.9036208736110	18.8331728901727	18.7619790620754	18.6900319109512	18.6173240029894	18.5438479541818	18.4695964357469	18.3945621797375	18.3187379848327	18.2421167223210	18.1711799880893	18.1041460851000	18.0361888274578	17.9673000069287	17.8974715058610	17.8266953047348	17.7549634899475	17.6822682618377	17.6086019429498	17.5339569865434	17.4583259853492	17.3817016805741	17.3040769711575	17.2254449232816	17.1457987801357	17.0651319719376	16.9834381262129	16.9007110783314	16.8169448823039	16.7321338218367	16.6462724216458	16.5593554590280	16.4713779756901	16.3823352898322	16.2922230084850	16.2010370400979	16.1087736073735	16.0154292603475	15.9210008897067	15.8254857403430	15.7288814251349	15.6311859389532	15.5323976728819	15.4351530746313	15.3436988411583	15.2510400173513	15.1571743763450	15.0621001541734	14.9658160665735	14.8683213259980	14.7696156588260	14.6696993227559	14.5685731243669	14.4662384368306	14.3626972177583	14.2579520271613	14.1520060455075	14.0448630918503	13.9365276420089	13.8270048467737	13.7163005501137	13.6044213073557	13.4913744033098	13.3771678703080	13.2618105061264	13.1453118917569	13.0276824089927	12.9089332577927	12.7890764733842	12.6681249430669	12.5460924226744	12.4229935526506	12.2988438736972	12.1736598419444	12.0474588435974	11.9202592090086	11.7920802261255	11.6629421532587	11.5328662311187	11.4018746940635	11.2699907805008	11.1372387423856	11.0036438537542	10.8692324182321	10.7340317754561	10.5980703063442	10.4613774371533	10.3239836422563	10.1859204455761	10.0472204206095	9.90791718897584	9.76804541742304	9.62764081322724	9.48674011791881	9.34538109927020	9.20360254148173	9.06144423350170	8.91894695541896	8.77615246286780	8.63310346938630	8.48984362667205	8.34641750268122	8.20287055751991	8.05924911707983	7.91560034437392	7.77197220853119	7.62841345141459	7.48497355183018	7.34170268730067	7.19865169338236	7.05587202050979	6.91341568835895	6.77133523772645	6.62968367992898	6.48851444373517	6.34788131984946	6.20783840297606	6.06844003149960	5.92974072482837	5.79179511845504	5.65465789679970	5.51838372391021	5.38302717210494	5.24864264865386	5.11528432060452	4.98300603787078	4.85186125471331	4.72190294975200	4.59318354466218	4.46575482171773	4.33966784035563	4.21497285294784	4.09171921997772	3.96995532482851	3.84972848840303	3.73108488380313	3.61406945130770	3.49872581389739	3.38509619358274	3.27322132880051	3.16314039315044	3.05489091575073	2.94850870349641	2.84402776550901	2.74148024006910	2.64089632432580	2.54230420707802	2.44573000492135	2.35119770205343	2.25872909402613	2.16834373572868	2.08005889387891	1.99388950429138	1.90984813418120	1.82794494975068	1.74818768929207	1.67058164202452	1.59512963286617	1.52183201332323	1.45068665865743	1.38168897147065	1.31483189182165	1.25010591396424	1.18749910976894	1.12699715886215	1.06858338548681	1.01223880205789	0.957942159354440	0.905498666954820	0.854829916642789	0.806177170695788	0.759508111141807	0.714788556742153	0.671982554449995	0.631052475926796	0.591959118776950	0.554661812131153	0.519118526181388	0.485285985244035	0.453119783903504	0.422574505766945	0.393603844341140	0.366160725526076	0.340197431206028	0.315665723408456	0.292516968493816	0.270702260835677	0.250172545450404	0.230878739039263	0.212771848913106	0.195803089280903	0.179923994398253	0.165086528090594	0.151243189188041	0.138347112434502	0.126352164462764	0.115213034459468	0.104885319178958	0.0953256020026878	0.0864915257809111	0.0783418592353588	0.0708365567451721	0.0639368113831703	0.0576051011151036	0.0518052281205037	0.0465023512396200	0.0416630115963068	0.0372551514911659	0.0332481267022795	0.0296127123721411	0.0263211026984357	0.0233469046828073	0.0206651262253205	0.0182521588826613	0.0160857556349673	0.0141450040292952	0.0124102950869468	0.0108632883770645	0.00948687366996857	0.00826512959065107	0.00718327969566008	0.00622764639540951	0.00538560313884464	0.00464552526857434	0.00399673994226420	0.00342947550054253	0.00293481064319541	0.00250462375436114	0.00213154269412756	0.00180889534876915	0.00153066120522108	0.00129142418766972	0.00108632696573793	0.000911026915042876	0.000761653882280691	0.000634769878795371	0.000527330799151893	0.000436650234853803	0.000360365428291631	0.000296405388511858	0.000242961168650447	0.000198458285033642	0.000161531240126446	0.000131000095779328	0.000105849029622782	8.52067959858347e-05	6.83290033336273e-05	5.45821128643878e-05	4.34290574839721e-05	3.44163767691871e-05	2.71627616028229e-05	2.13489017616591e-05	1.67085307010936e-05	1.30205639369856e-05	1.01022306047076e-05	7.80310180615572e-06	5.99992407083083e-06	4.59217149757157e-06	3.49823575938879e-06	2.65217900717187e-06	2.00098067409111e-06	1.50221515095670e-06	1.12210317808004e-06	8.33885500840269e-07	6.16472798479812e-07	4.53331067140668e-07	3.31566480666737e-07	2.41178240378241e-07	1.74427860437332e-07	1.25418354017079e-07	8.96583257738015e-08	6.37177246734468e-08	4.50116615401019e-08	3.16037951117635e-08	2.20524217948789e-08	1.52907517969735e-08	1.05343728502823e-08	7.21019130708357e-09	4.90222501437175e-09	3.31052800562371e-09	2.22027714808987e-09	1.47866716956771e-09	9.77762748766242e-10	6.41862372140432e-10	4.18254209099894e-10	2.70503149318011e-10	1.73612332459507e-10	1.10562204493109e-10	6.98540007876489e-11	4.37798148548980e-11	2.72140450053847e-11	1.67759159129516e-11	1.02539139644741e-11	6.21353270782676e-12	3.73221854123301e-12	2.22181558967920e-12	1.31066937030851e-12	7.66042772480787e-13	4.43523799213054e-13	2.54338993715012e-13	1.44433483657166e-13	8.12095798292332e-14	4.52017546956714e-14	2.49020362581161e-14	1.35758644584862e-14	7.32273539646411e-15	3.90724958553483e-15	2.06195057991947e-15	1.07599562600826e-15	5.55114162499256e-16	2.83078278480647e-16	1.42657490435828e-16	7.10323547742949e-17	3.49381303690577e-17	1.69719417827923e-17	8.14060712572878e-18	3.85459492997871e-18	1.80135364710433e-18	8.30648679994556e-19	3.77860980530069e-19	1.69527169497273e-19	7.49952355524827e-20	3.27045204711107e-20	1.40556978502367e-20	5.95191063369248e-21	2.48259941060437e-21	1.01973672449374e-21	4.12366641896825e-22	1.64124674183545e-22	6.42743733436497e-23	2.47600807905198e-23	9.37974297533926e-24	3.49322636863999e-24	1.27858447350662e-24	4.59797639972358e-25	1.62406741033094e-25	5.63254137789300e-26	1.91746909691858e-26	6.40522174175936e-27	2.09883093951355e-27	6.74390406721787e-28	2.12415651336586e-28	6.55617879334336e-29	1.98015855735874e-29	5.85188895728496e-30	1.69282371768113e-30	4.79163687826095e-31	1.32662036709544e-31	3.59113061162486e-32	9.50092163902055e-33	2.45570088191364e-33	6.19844171699315e-34	1.52723515103299e-34	3.67165159540032e-35	8.60917977238895e-36	1.96795949104623e-36	4.38359633663071e-37	9.51059152124382e-38	2.00884375606670e-38	4.12897260817583e-39	8.25442872176677e-40	1.60424070684464e-40	3.02952212848703e-41	5.55624805096084e-42	9.89165561799857e-43	1.70847749808646e-43	2.86135350336219e-44	4.64430522166338e-45	7.30159700518952e-46	1.11126981094412e-46	1.63635728953377e-47	2.32992413562131e-48	3.20593040401845e-49	4.26043754721585e-50	5.46483026285028e-51	6.76163009285716e-52	8.06498473098098e-53	9.26730440017455e-54	1.02521856305284e-54	1.09119675714499e-55	1.11665387943074e-56	1.09790094290524e-57	1.03641024702414e-58	9.38671725863257e-60	8.15067090295679e-61	6.78030298018571e-62	5.39950388187773e-63	4.11315217557028e-64	2.99483682265247e-65	2.08259285717956e-66	1.38203077087517e-67	8.74492975030638e-69	5.27177773338168e-70	3.02517508638295e-71	1.65105146589565e-72	8.56258295284184e-74	4.21593349711886e-75	1.96893485967077e-76	8.71393834872525e-78	3.65117777339961e-79	1.44700308230613e-80	5.41875113057228e-82	1.91553485692545e-83	6.38560809842253e-85	2.00534145924835e-86	5.92642696871404e-88	1.64646590385592e-89	4.29532744845217e-91	1.05109941943829e-92	2.40994496829534e-94	5.17117838735606e-96	1.03725493618518e-97	1.94258822741841e-99	3.39275007866669e-101	5.51907496032872e-103	8.35183878974649e-105	1.17421564641492e-106	1.53180136880259e-108	1.85171821955312e-110	2.07149649116750e-112	2.14160393855121e-114	2.04332843747168e-116	1.79667332376268e-118	1.45381477730244e-120	1.08099632961900e-122	7.37512817597246e-125	4.60987175772279e-127	2.63581068318410e-129	1.37646805106056e-131	6.55470466410771e-134	2.84165643543208e-136	1.11970979832849e-138	4.00337528572621e-141	1.29656023581710e-143	3.79708479961998e-146];
P2_P1 = 1 + 2*gamma/(gamma+1)*(M1.^2-1);
Pstag_P2 = ((gamma+1)^2*M1.^2./(4*gamma*M1.^2-2*(gamma-1))).^3; %.^(gamma/(gamma-1)) makes double complex
C_p0 = 2./(gamma*M1.^2).*(P2_P1 .* Pstag_P2-1);
C_p0_limit =  (4/(gamma+1))*((gamma+1)^2/(4*gamma))^((gamma)/(gamma-1));
Z_analytical = [120000	119879.879879880	119759.759759760	119639.639639640	119519.519519520	119399.399399399	119279.279279279	119159.159159159	119039.039039039	118918.918918919	118798.798798799	118678.678678679	118558.558558559	118438.438438438	118318.318318318	118198.198198198	118078.078078078	117957.957957958	117837.837837838	117717.717717718	117597.597597598	117477.477477477	117357.357357357	117237.237237237	117117.117117117	116996.996996997	116876.876876877	116756.756756757	116636.636636637	116516.516516517	116396.396396396	116276.276276276	116156.156156156	116036.036036036	115915.915915916	115795.795795796	115675.675675676	115555.555555556	115435.435435435	115315.315315315	115195.195195195	115075.075075075	114954.954954955	114834.834834835	114714.714714715	114594.594594595	114474.474474474	114354.354354354	114234.234234234	114114.114114114	113993.993993994	113873.873873874	113753.753753754	113633.633633634	113513.513513514	113393.393393393	113273.273273273	113153.153153153	113033.033033033	112912.912912913	112792.792792793	112672.672672673	112552.552552553	112432.432432432	112312.312312312	112192.192192192	112072.072072072	111951.951951952	111831.831831832	111711.711711712	111591.591591592	111471.471471471	111351.351351351	111231.231231231	111111.111111111	110990.990990991	110870.870870871	110750.750750751	110630.630630631	110510.510510511	110390.390390390	110270.270270270	110150.150150150	110030.030030030	109909.909909910	109789.789789790	109669.669669670	109549.549549550	109429.429429429	109309.309309309	109189.189189189	109069.069069069	108948.948948949	108828.828828829	108708.708708709	108588.588588589	108468.468468468	108348.348348348	108228.228228228	108108.108108108	107987.987987988	107867.867867868	107747.747747748	107627.627627628	107507.507507508	107387.387387387	107267.267267267	107147.147147147	107027.027027027	106906.906906907	106786.786786787	106666.666666667	106546.546546547	106426.426426426	106306.306306306	106186.186186186	106066.066066066	105945.945945946	105825.825825826	105705.705705706	105585.585585586	105465.465465465	105345.345345345	105225.225225225	105105.105105105	104984.984984985	104864.864864865	104744.744744745	104624.624624625	104504.504504505	104384.384384384	104264.264264264	104144.144144144	104024.024024024	103903.903903904	103783.783783784	103663.663663664	103543.543543544	103423.423423423	103303.303303303	103183.183183183	103063.063063063	102942.942942943	102822.822822823	102702.702702703	102582.582582583	102462.462462462	102342.342342342	102222.222222222	102102.102102102	101981.981981982	101861.861861862	101741.741741742	101621.621621622	101501.501501502	101381.381381381	101261.261261261	101141.141141141	101021.021021021	100900.900900901	100780.780780781	100660.660660661	100540.540540541	100420.420420420	100300.300300300	100180.180180180	100060.060060060	99939.9399399399	99819.8198198198	99699.6996996997	99579.5795795796	99459.4594594595	99339.3393393393	99219.2192192192	99099.0990990991	98978.9789789790	98858.8588588589	98738.7387387387	98618.6186186186	98498.4984984985	98378.3783783784	98258.2582582583	98138.1381381381	98018.0180180180	97897.8978978979	97777.7777777778	97657.6576576577	97537.5375375375	97417.4174174174	97297.2972972973	97177.1771771772	97057.0570570571	96936.9369369369	96816.8168168168	96696.6966966967	96576.5765765766	96456.4564564565	96336.3363363363	96216.2162162162	96096.0960960961	95975.9759759760	95855.8558558559	95735.7357357357	95615.6156156156	95495.4954954955	95375.3753753754	95255.2552552553	95135.1351351351	95015.0150150150	94894.8948948949	94774.7747747748	94654.6546546547	94534.5345345345	94414.4144144144	94294.2942942943	94174.1741741742	94054.0540540541	93933.9339339339	93813.8138138138	93693.6936936937	93573.5735735736	93453.4534534535	93333.3333333333	93213.2132132132	93093.0930930931	92972.9729729730	92852.8528528529	92732.7327327327	92612.6126126126	92492.4924924925	92372.3723723724	92252.2522522523	92132.1321321321	92012.0120120120	91891.8918918919	91771.7717717718	91651.6516516517	91531.5315315315	91411.4114114114	91291.2912912913	91171.1711711712	91051.0510510511	90930.9309309309	90810.8108108108	90690.6906906907	90570.5705705706	90450.4504504504	90330.3303303303	90210.2102102102	90090.0900900901	89969.9699699700	89849.8498498499	89729.7297297297	89609.6096096096	89489.4894894895	89369.3693693694	89249.2492492493	89129.1291291291	89009.0090090090	88888.8888888889	88768.7687687688	88648.6486486487	88528.5285285285	88408.4084084084	88288.2882882883	88168.1681681682	88048.0480480481	87927.9279279279	87807.8078078078	87687.6876876877	87567.5675675676	87447.4474474475	87327.3273273273	87207.2072072072	87087.0870870871	86966.9669669670	86846.8468468469	86726.7267267267	86606.6066066066	86486.4864864865	86366.3663663664	86246.2462462462	86126.1261261261	86006.0060060060	85885.8858858859	85765.7657657658	85645.6456456457	85525.5255255255	85405.4054054054	85285.2852852853	85165.1651651652	85045.0450450450	84924.9249249249	84804.8048048048	84684.6846846847	84564.5645645646	84444.4444444444	84324.3243243243	84204.2042042042	84084.0840840841	83963.9639639640	83843.8438438439	83723.7237237237	83603.6036036036	83483.4834834835	83363.3633633634	83243.2432432432	83123.1231231231	83003.0030030030	82882.8828828829	82762.7627627628	82642.6426426426	82522.5225225225	82402.4024024024	82282.2822822823	82162.1621621622	82042.0420420420	81921.9219219219	81801.8018018018	81681.6816816817	81561.5615615616	81441.4414414415	81321.3213213213	81201.2012012012	81081.0810810811	80960.9609609610	80840.8408408408	80720.7207207207	80600.6006006006	80480.4804804805	80360.3603603604	80240.2402402402	80120.1201201201	80000	79879.8798798799	79759.7597597598	79639.6396396396	79519.5195195195	79399.3993993994	79279.2792792793	79159.1591591592	79039.0390390390	78918.9189189189	78798.7987987988	78678.6786786787	78558.5585585586	78438.4384384384	78318.3183183183	78198.1981981982	78078.0780780781	77957.9579579580	77837.8378378378	77717.7177177177	77597.5975975976	77477.4774774775	77357.3573573574	77237.2372372372	77117.1171171171	76996.9969969970	76876.8768768769	76756.7567567568	76636.6366366366	76516.5165165165	76396.3963963964	76276.2762762763	76156.1561561562	76036.0360360360	75915.9159159159	75795.7957957958	75675.6756756757	75555.5555555556	75435.4354354354	75315.3153153153	75195.1951951952	75075.0750750751	74954.9549549550	74834.8348348348	74714.7147147147	74594.5945945946	74474.4744744745	74354.3543543544	74234.2342342342	74114.1141141141	73993.9939939940	73873.8738738739	73753.7537537538	73633.6336336336	73513.5135135135	73393.3933933934	73273.2732732733	73153.1531531532	73033.0330330330	72912.9129129129	72792.7927927928	72672.6726726727	72552.5525525525	72432.4324324324	72312.3123123123	72192.1921921922	72072.0720720721	71951.9519519520	71831.8318318318	71711.7117117117	71591.5915915916	71471.4714714715	71351.3513513514	71231.2312312312	71111.1111111111	70990.9909909910	70870.8708708709	70750.7507507508	70630.6306306306	70510.5105105105	70390.3903903904	70270.2702702703	70150.1501501502	70030.0300300300	69909.9099099099	69789.7897897898	69669.6696696697	69549.5495495496	69429.4294294294	69309.3093093093	69189.1891891892	69069.0690690691	68948.9489489490	68828.8288288288	68708.7087087087	68588.5885885886	68468.4684684685	68348.3483483483	68228.2282282282	68108.1081081081	67987.9879879880	67867.8678678679	67747.7477477478	67627.6276276276	67507.5075075075	67387.3873873874	67267.2672672673	67147.1471471472	67027.0270270270	66906.9069069069	66786.7867867868	66666.6666666667	66546.5465465465	66426.4264264264	66306.3063063063	66186.1861861862	66066.0660660661	65945.9459459460	65825.8258258258	65705.7057057057	65585.5855855856	65465.4654654655	65345.3453453454	65225.2252252252	65105.1051051051	64984.9849849850	64864.8648648649	64744.7447447447	64624.6246246246	64504.5045045045	64384.3843843844	64264.2642642643	64144.1441441441	64024.0240240240	63903.9039039039	63783.7837837838	63663.6636636637	63543.5435435435	63423.4234234234	63303.3033033033	63183.1831831832	63063.0630630631	62942.9429429429	62822.8228228228	62702.7027027027	62582.5825825826	62462.4624624625	62342.3423423423	62222.2222222222	62102.1021021021	61981.9819819820	61861.8618618619	61741.7417417417	61621.6216216216	61501.5015015015	61381.3813813814	61261.2612612613	61141.1411411411	61021.0210210210	60900.9009009009	60780.7807807808	60660.6606606607	60540.5405405405	60420.4204204204	60300.3003003003	60180.1801801802	60060.0600600601	59939.9399399399	59819.8198198198	59699.6996996997	59579.5795795796	59459.4594594595	59339.3393393393	59219.2192192192	59099.0990990991	58978.9789789790	58858.8588588589	58738.7387387387	58618.6186186186	58498.4984984985	58378.3783783784	58258.2582582583	58138.1381381381	58018.0180180180	57897.8978978979	57777.7777777778	57657.6576576577	57537.5375375375	57417.4174174174	57297.2972972973	57177.1771771772	57057.0570570571	56936.9369369369	56816.8168168168	56696.6966966967	56576.5765765766	56456.4564564565	56336.3363363363	56216.2162162162	56096.0960960961	55975.9759759760	55855.8558558559	55735.7357357357	55615.6156156156	55495.4954954955	55375.3753753754	55255.2552552553	55135.1351351351	55015.0150150150	54894.8948948949	54774.7747747748	54654.6546546547	54534.5345345345	54414.4144144144	54294.2942942943	54174.1741741742	54054.0540540541	53933.9339339339	53813.8138138138	53693.6936936937	53573.5735735736	53453.4534534535	53333.3333333333	53213.2132132132	53093.0930930931	52972.9729729730	52852.8528528529	52732.7327327327	52612.6126126126	52492.4924924925	52372.3723723724	52252.2522522523	52132.1321321321	52012.0120120120	51891.8918918919	51771.7717717718	51651.6516516517	51531.5315315315	51411.4114114114	51291.2912912913	51171.1711711712	51051.0510510511	50930.9309309309	50810.8108108108	50690.6906906907	50570.5705705706	50450.4504504504	50330.3303303303	50210.2102102102	50090.0900900901	49969.9699699700	49849.8498498499	49729.7297297297	49609.6096096096	49489.4894894895	49369.3693693694	49249.2492492492	49129.1291291291	49009.0090090090	48888.8888888889	48768.7687687688	48648.6486486487	48528.5285285285	48408.4084084084	48288.2882882883	48168.1681681682	48048.0480480481	47927.9279279279	47807.8078078078	47687.6876876877	47567.5675675676	47447.4474474474	47327.3273273273	47207.2072072072	47087.0870870871	46966.9669669670	46846.8468468469	46726.7267267267	46606.6066066066	46486.4864864865	46366.3663663664	46246.2462462462	46126.1261261261	46006.0060060060	45885.8858858859	45765.7657657658	45645.6456456457	45525.5255255255	45405.4054054054	45285.2852852853	45165.1651651652	45045.0450450450	44924.9249249249	44804.8048048048	44684.6846846847	44564.5645645646	44444.4444444444	44324.3243243243	44204.2042042042	44084.0840840841	43963.9639639640	43843.8438438438	43723.7237237237	43603.6036036036	43483.4834834835	43363.3633633634	43243.2432432432	43123.1231231231	43003.0030030030	42882.8828828829	42762.7627627628	42642.6426426427	42522.5225225225	42402.4024024024	42282.2822822823	42162.1621621622	42042.0420420420	41921.9219219219	41801.8018018018	41681.6816816817	41561.5615615616	41441.4414414414	41321.3213213213	41201.2012012012	41081.0810810811	40960.9609609610	40840.8408408408	40720.7207207207	40600.6006006006	40480.4804804805	40360.3603603604	40240.2402402402	40120.1201201201	40000	39879.8798798799	39759.7597597598	39639.6396396396	39519.5195195195	39399.3993993994	39279.2792792793	39159.1591591592	39039.0390390390	38918.9189189189	38798.7987987988	38678.6786786787	38558.5585585586	38438.4384384384	38318.3183183183	38198.1981981982	38078.0780780781	37957.9579579580	37837.8378378378	37717.7177177177	37597.5975975976	37477.4774774775	37357.3573573574	37237.2372372372	37117.1171171171	36996.9969969970	36876.8768768769	36756.7567567568	36636.6366366366	36516.5165165165	36396.3963963964	36276.2762762763	36156.1561561562	36036.0360360360	35915.9159159159	35795.7957957958	35675.6756756757	35555.5555555556	35435.4354354354	35315.3153153153	35195.1951951952	35075.0750750751	34954.9549549550	34834.8348348348	34714.7147147147	34594.5945945946	34474.4744744745	34354.3543543544	34234.2342342342	34114.1141141141	33993.9939939940	33873.8738738739	33753.7537537538	33633.6336336336	33513.5135135135	33393.3933933934	33273.2732732733	33153.1531531532	33033.0330330330	32912.9129129129	32792.7927927928	32672.6726726727	32552.5525525526	32432.4324324324	32312.3123123123	32192.1921921922	32072.0720720721	31951.9519519520	31831.8318318318	31711.7117117117	31591.5915915916	31471.4714714715	31351.3513513513	31231.2312312312	31111.1111111111	30990.9909909910	30870.8708708709	30750.7507507508	30630.6306306306	30510.5105105105	30390.3903903904	30270.2702702703	30150.1501501501	30030.0300300300	29909.9099099099	29789.7897897898	29669.6696696697	29549.5495495496	29429.4294294294	29309.3093093093	29189.1891891892	29069.0690690691	28948.9489489490	28828.8288288288	28708.7087087087	28588.5885885886	28468.4684684685	28348.3483483483	28228.2282282282	28108.1081081081	27987.9879879880	27867.8678678679	27747.7477477478	27627.6276276276	27507.5075075075	27387.3873873874	27267.2672672673	27147.1471471471	27027.0270270270	26906.9069069069	26786.7867867868	26666.6666666667	26546.5465465466	26426.4264264264	26306.3063063063	26186.1861861862	26066.0660660661	25945.9459459459	25825.8258258258	25705.7057057057	25585.5855855856	25465.4654654655	25345.3453453453	25225.2252252252	25105.1051051051	24984.9849849850	24864.8648648649	24744.7447447448	24624.6246246246	24504.5045045045	24384.3843843844	24264.2642642643	24144.1441441441	24024.0240240240	23903.9039039039	23783.7837837838	23663.6636636637	23543.5435435436	23423.4234234234	23303.3033033033	23183.1831831832	23063.0630630631	22942.9429429429	22822.8228228228	22702.7027027027	22582.5825825826	22462.4624624625	22342.3423423423	22222.2222222222	22102.1021021021	21981.9819819820	21861.8618618619	21741.7417417417	21621.6216216216	21501.5015015015	21381.3813813814	21261.2612612613	21141.1411411411	21021.0210210210	20900.9009009009	20780.7807807808	20660.6606606607	20540.5405405405	20420.4204204204	20300.3003003003	20180.1801801802	20060.0600600601	19939.9399399399	19819.8198198198	19699.6996996997	19579.5795795796	19459.4594594595	19339.3393393393	19219.2192192192	19099.0990990991	18978.9789789790	18858.8588588589	18738.7387387387	18618.6186186186	18498.4984984985	18378.3783783784	18258.2582582583	18138.1381381381	18018.0180180180	17897.8978978979	17777.7777777778	17657.6576576577	17537.5375375375	17417.4174174174	17297.2972972973	17177.1771771772	17057.0570570571	16936.9369369369	16816.8168168168	16696.6966966967	16576.5765765766	16456.4564564565	16336.3363363363	16216.2162162162	16096.0960960961	15975.9759759760	15855.8558558559	15735.7357357357	15615.6156156156	15495.4954954955	15375.3753753754	15255.2552552553	15135.1351351351	15015.0150150150	14894.8948948949	14774.7747747748	14654.6546546547	14534.5345345345	14414.4144144144	14294.2942942943	14174.1741741742	14054.0540540541	13933.9339339339	13813.8138138138	13693.6936936937	13573.5735735736	13453.4534534534	13333.3333333333	13213.2132132132	13093.0930930931	12972.9729729730	12852.8528528529	12732.7327327327	12612.6126126126	12492.4924924925	12372.3723723724	12252.2522522522	12132.1321321321	12012.0120120120	11891.8918918919	11771.7717717718	11651.6516516517	11531.5315315315	11411.4114114114	11291.2912912913	11171.1711711712	11051.0510510511	10930.9309309309	10810.8108108108	10690.6906906907	10570.5705705706	10450.4504504504	10330.3303303303	10210.2102102102	10090.0900900901	9969.96996996997	9849.84984984985	9729.72972972973	9609.60960960962	9489.48948948948	9369.36936936936	9249.24924924925	9129.12912912913	9009.00900900901	8888.88888888889	8768.76876876877	8648.64864864865	8528.52852852854	8408.40840840840	8288.28828828828	8168.16816816817	8048.04804804805	7927.92792792793	7807.80780780781	7687.68768768769	7567.56756756757	7447.44744744744	7327.32732732732	7207.20720720720	7087.08708708709	6966.96696696697	6846.84684684685	6726.72672672673	6606.60660660661	6486.48648648648	6366.36636636636	6246.24624624624	6126.12612612612	6006.00600600601	5885.88588588589	5765.76576576577	5645.64564564565	5525.52552552553	5405.40540540540	5285.28528528528	5165.16516516516	5045.04504504504	4924.92492492493	4804.80480480481	4684.68468468469	4564.56456456457	4444.44444444444	4324.32432432432	4204.20420420420	4084.08408408408	3963.96396396396	3843.84384384385	3723.72372372373	3603.60360360361	3483.48348348348	3363.36336336336	3243.24324324324	3123.12312312312	3003.00300300300	2882.88288288288	2762.76276276277	2642.64264264265	2522.52252252253	2402.40240240240	2282.28228228228	2162.16216216216	2042.04204204204	1921.92192192192	1801.80180180180	1681.68168168169	1561.56156156157	1441.44144144144	1321.32132132132	1201.20120120120	1081.08108108108	960.960960960962	840.840840840843	720.720720720725	600.600600600606	480.480480480474	360.360360360355	240.240240240237	120.120120120118	0];

%% Read the mesh and find the vectors
TR = stlread('CAD_capsule_3.stl');
P = incenter(TR);
F = faceNormal(TR);
%quiver3(P(:,1),P(:,2),P(:,3), ...
%F(:,1),F(:,2),F(:,3),2,'color','black');

vx = velocity1*sin(alpha); 
vy = 0; 
vz = velocity1*cos(alpha); 
V = [vx, vy, vz]; 
thetas = []; 
Cp = []; 



for i = 1:length(F)
    N = F(i,:); 
    sin_theta = sum((V.*N)/velocity1); 
    thetas(i) = asin(sin_theta); 
    if thetas(i) <= 0
        Cp(i) = 0; 
    else
        Cp(i) = 2 * (sin(thetas(i)))^2;
    end
end


thetas = reshape(thetas, [16348, 1]); 
Cp = reshape(Cp, [16348, 1]); 


%% Read and calculate modified Newtonian
TR = stlread('CAD_capsule_3.stl');
P = incenter(TR);
F = faceNormal(TR);
%quiver3(P(:,1),P(:,2),P(:,3), ...
%F(:,1),F(:,2),F(:,3),2,'color','black');

vx = velocity.*sin(alpha); 
vy = 0; 
vz = velocity.*cos(alpha);  
V = ones(3,1000);
V(1,:) = vx;
V(2,:) = vy;
V(3,:) = vz;
thetas = []; 
%Cp = []; 
Cps = [];

for j = 1:length(M1)
    for i = 1:length(F)
        N = F(i, :); 
        sin_theta = sum((V(:,j).'.*N)/velocity(j)); 
        thetas(i) = asin(sin_theta); % make 3 rows
        if thetas(i) <= 0
            Cps(i,j) = 0;
        else
            Cps(i,j) = C_p0(j) * (sin(thetas(i)))^2;
        end
    end
end

thetas = reshape(thetas, [length(thetas), 1]); 
Cps = reshape(Cps, [length(Cps), 1000]); 


%% Finding CP along the velocity application line
vect_indices_1 = find(P(:,2) > -5); % the y coordinate will be 0 in the x-z plane, where the velocity is applied
vect_indices_2 = find(P(:,2) < 5); 
[vect_indices, eh] = intersect(vect_indices_1, vect_indices_2); 

cross_sec_cp = []; 
cross_sec_X = [];

enter_index = 1; 

for i = 1:length(vect_indices)
    k = vect_indices(i);
    cross_sec_X(enter_index) = P(k, 1); 
    cross_sec_cp(enter_index) = Cp(k); 
    enter_index = enter_index + 1; 
end

cross_sec_cp = reshape(cross_sec_cp, [length(cross_sec_cp), 1]);
cross_sec_X = reshape(cross_sec_X, [length(cross_sec_X), 1]);

% write to csv
 D = [cross_sec_X cross_sec_cp]; 
 csvwrite('Cp_along_xzplane', D);

%% Plotting Cp over time
figure(1); 
trisurf(TR, Cp, 'EdgeColor', 'none');  
hold on; 
axis equal; 
colorbar;
colormapeditor;

k = 0;
figure2 = figure;
for i = 525:775
    k = k + 1;
    if k <= 5
        continue
    end
    
    trisurf(TR, Cps(:,i), 'EdgeColor', 'none');
    axis equal;
    colorbar;
    colormapeditor;
    saveas(figure2, sprintf('PressureDist%d',i), 'jpg');
    k = 0;
    %saveas(figure2, sprintf('Downloads:\figures\PressureDist%d',i), 'jpg');
   
    %path='Downloads:\figures\';
    %saveas(figure(i),fullfile(path,['myPlot' num2str(i) '.jpeg']));
end

%% Plotting Cp vs Mach
Cpps = Cps(1,:);

figure(3)
axis([0 2 0 12000])
plot(M1, Cpps,'-.')
axis([0 12000 0 2])
legend(' ');
ylabel('Cp');
xlabel('Mach');
title('Cp vs Mach');

%% Plotting Cps along cross section
figure(4); 
scatter(cross_sec_X, cross_sec_cp); 
xlabel ('X (mm)'); 
ylabel ('C_p'); 
title('C_p v/s X Coordinate of Triangulation Points in X-Z Plane for Modified Newtonian Calculation')
